<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Discontinuity attributes - Geo-Data Science</title>
<meta name="description" content="Introduction">


  <meta name="author" content="Liliana Vargas-Meleza">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Geo-Data Science">
<meta property="og:title" content="Discontinuity attributes">
<meta property="og:url" content="http://localhost:4000/Discontinuity-attributes/">


  <meta property="og:description" content="Introduction">



  <meta property="og:image" content="http://localhost:4000/images/DSC_0006.JPG">





  <meta property="article:published_time" content="2020-07-30T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/Discontinuity-attributes/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Liliana Vargas-Meleza",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Geo-Data Science Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Geo-Data Science
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/cv/">CV</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/">Projects</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="/images/DSC_0006.JPG" alt="Discontinuity attributes" class="page__hero-image">
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/images/lvm2.jpg" alt="Liliana Vargas-Meleza" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Liliana Vargas-Meleza</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Geophysicist. Data Scientist. Geospatial enthusiast.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">The Hague, The Netherlands</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
      

      

      
        <li>
          <a href="mailto:liliana.meleza@gmail.com">
            <meta itemprop="email" content="liliana.meleza@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/lvargasmeleza" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span>
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/anailil" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Discontinuity attributes">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2020-07-30T00:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Discontinuity attributes
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="introduction">Introduction</h2>

<p>Discontinuity calculations, also called coherence or semblance, are some of the most commonly used seismic attributes. They measure the amount of similarity between adjacent seismic traces. However, there are several different types of discontinuity estimates and a plethora of names for similar attributes.</p>

<h2 id="cross-correlation">Cross-correlation</h2>
<p>The earliest discontinuity algorithm used the maximum cross-correlation value of three traces.  Each trace is correlated with a “moving-window” subset of two neighboring traces (Figures 1B and 2B). It was called <em>coherence attribute</em>, based on its conceptual similarity to pre-stack methods for estimating stacking velocities.</p>

<p>Cross-correlation approach to an arbitrary number of input traces is also referred to as “semblance-based coherence”. As an example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def moving_window(data, func, window):
  wrapped = lambda x: func(x.reshape(window))
  return scipy.ndimage.generic_filter(data,
                                      wrapped,
                                      window)

def marfurt_semblance(region):
  # Stack traces in 3D region into 2D array
  region = region.reshape(-1, region.shape[-1])
  ntraces, nsamples = region.shape
  square_sums = np.sum(region, axis=0)**2
  sum_squares = np.sum(region**2, axis=0)
  c = square_sums.sum() / square_sums.sum()
  return c / ntraces

result = moving_window(seismic_data,
                       marfurt_semblance,
                       (3, 3, 9))
</code></pre></div></div>

<h2 id="removing-amplitude-sensitivity">Removing Amplitude Sensitivity</h2>

<p>Methods to compute discontinuity are sensitive to lateral differences in amplitude as well as in phase. While this is desirable for detecting stratigraphic features, differences due amplitude can obscure subtle structural features. <em>Eigenstructure-based coherence</em> is an implementation that is sensitive only to lateral changes in phase of the input waveforms.</p>

<p>Eigenstructure-based coherence (Gersztenkorn and Marfurt, 1999) computes the covariance matrix of the input region, similar to the previous example. However, it uses the ratio of the largest eigenvalue of the covariance matrix to the sum of the eigenvalues:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def gersztenkorn(region):
  # Stack traces in 3D region into 2D array
  region = region.reshape(-1, region.shape[-1])

  # Calculate eigenvalues of covariance matrix
  cov = region.dot(region.T)
  vals = np.linalg.eigvalsh(cov)
  return vals.max() / vals.sum()

result = moving_window(seismic_data,
                       gersztenkorn,
                       (3, 3, 9))
</code></pre></div></div>

<p>Conceptually, this is similar to treating each seismic trace within the moving window as a separate dimension and calculating how well the resulting point cloud is fit by a plane.</p>

<h2 id="gradient-changes-instead-of-trace-similarity">Gradient Changes Instead of Trace Similarity</h2>

<p>The structure tensor measures how the gradient of each dimension co-varies locally. A number of useful attributes can be computed from the ratios of the eigenvalues of the structure tensor, one of which is a measure of how planar the data is locally, which we’ll refer to as GST coherence.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from scipy.ndimage import gaussian_filter1d

def gradients(seismic, sigma):
  grads = []
  for axis in range(3):
    grad = gaussian_filter1d(seismic, sigma,
	                         axis=axis, order=1)
    grads.append(grad[..., np.newaxis])
  return np.concatenate(grads, axis=3)

def gst_coherence_calc(region):
  region = region.reshape(-1, 3)
  gst = region.T.dot(region)
  eigs = np.sort(np.linalg.eigvalsh(gst))[::-1]
  return (eigs[0]-eigs[1]) / (eigs[0]+eigs[1])

def gst_coherence(seismic, window, sigma=1):
  grad = gradients(seismic, sigma)
  return moving_window4d(grad_array,
                         window,
                         gst_coherence_calc)
</code></pre></div></div>

<p>Because GST coherence measures change in the local slope of the data, it is more closely related to curvature attributes than to the other discontinuity attributes. Therefore, it can reveal different features than discontinuity attributes that compare waveform similarity, but tends to show thicker regions of discontinuity around faults.</p>

<h2 id="final-remarks">Final Remarks</h2>

<p>Discontinuity attributes are a fundamental part of an interpreter’s toolkit when working with 3D data. While most interpreters are familiar with using discontinuity attributes, few are familiar with how they’re implemented or the differences between similar attributes. Hopefully the accompanying Jupyter notebook and this brief tutorial helps clear up some implementation details and inspires you to attempt new variants on well-known discontinuity attributes.</p>

<h2 id="figures">Figures</h2>

<p><img src="http://localhost:4000/images/figure_1.png" alt="alt" /></p>

<p><strong>Figure 1</strong>: A comparison of the discontinuity algorithms discussed.</p>

<p><img src="http://localhost:4000/images/figure_2.png" alt="alt" /></p>

<p><strong>Figure 2</strong>: A visual explanation of the differences between the discontinuity algorithms discussed using only two traces. “C” indicates the calculated coherence value.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#attributes" class="page__taxonomy-item" rel="tag">attributes</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#geo" class="page__taxonomy-item" rel="tag">geo</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#post" class="page__taxonomy-item" rel="tag">post</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#seismic" class="page__taxonomy-item" rel="tag">seismic</a>
    
    </span>
  </p>




        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-07-30T00:00:00+02:00">July 30, 2020</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Salt-characterisation/" class="pagination--pager" title="Salt characterisation
">Previous</a>
    
    
      <a href="/Sedimentary-facies-classification/" class="pagination--pager" title="Sedimentary facies classification
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Liliana Vargas-Meleza. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>







  </body>
</html>
